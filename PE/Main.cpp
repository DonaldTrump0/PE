#include <stdio.h>
#include <stdlib.h>
#include <windows.h>
#include "PETools.h"

int main() {
	//char pFilePath[] = "C:/Users/12269/Desktop/MyDll.dll";
	char pFilePath[] = "C:/Users/12269/Desktop/notepad.exe";

	//void* pFileBuffer = NULL;
	//readPEFile(pFilePath, &pFileBuffer);
	//void* pImageBuffer = NULL;
	//copyFileBufferToImageBuffer(pFileBuffer, &pImageBuffer);
	//void* pNewBuffer = NULL;
	//int sizeOfFile = copyImageBufferToNewBuffer(pImageBuffer, &pNewBuffer);
	//writeFileBufferToFile("C:/Users/12269/Desktop/IPMsg2.exe", pNewBuffer, sizeOfFile);
	//printPEHeader(pFilePath);
	//injectShellCode(pFilePath, 2);
	//addSection(pFilePath);
	//expandLastSection(pFilePath);
	//MergeSections(pFilePath);
	//printDataDirectory(pFilePath);
	//printExportDirectory(pFilePath);
	//printf("\n%x\n", GetFunctionAddrByName(pFilePath, "Plus"));
	//printf("\n%x\n", GetFunctionAddrByOrdinal(pFilePath, 12));
	//printBaseRelocation(pFilePath);
	//moveExportDirectory(pFilePath);
	//moveBaseRelocation(pFilePath);
	//modifyImageBase(pFilePath, 0x20000000);
	//printImportDirectory(pFilePath);
	//printBoundImportDirectory(pFilePath);
	//injectImportDirectory(pFilePath);
	//printResourceDirectory(pFilePath);
}
